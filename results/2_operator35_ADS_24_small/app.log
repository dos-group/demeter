[INFO ] 2023-09-19 06:41:26.441 [main] Context - Reserving NodePort: 32760
[INFO ] 2023-09-19 06:41:26.762 [main] SequenceFSM - STATE-CHANGE: START -> INITIALIZE
[INFO ] 2023-09-19 06:41:27.230 [OkHttp https://10.233.0.1/...] K8sClient - Namespace (operator) ADDED
[INFO ] 2023-09-19 06:41:27.232 [main] ClientsManager - Helm deploy: { redis-cluster: { repo : https://charts.bitnami.com/bitnami },{ values : kubernetes/redis-cluster/values.yaml },{ version : 7.6.4 } }
[INFO ] 2023-09-19 06:41:30.502 [pool-4-thread-1] Helm - NAME: redis-cluster
[INFO ] 2023-09-19 06:41:30.503 [pool-4-thread-1] Helm - LAST DEPLOYED: Tue Sep 19 06:41:29 2023
[INFO ] 2023-09-19 06:41:30.503 [pool-4-thread-1] Helm - NAMESPACE: operator
[INFO ] 2023-09-19 06:41:30.503 [pool-4-thread-1] Helm - STATUS: deployed
[INFO ] 2023-09-19 06:41:30.503 [pool-4-thread-1] Helm - REVISION: 1
[INFO ] 2023-09-19 06:41:30.504 [pool-4-thread-1] Helm - TEST SUITE: None
[INFO ] 2023-09-19 06:41:30.504 [pool-4-thread-1] Helm - NOTES:
[INFO ] 2023-09-19 06:41:30.504 [pool-4-thread-1] Helm - CHART NAME: redis-cluster
[INFO ] 2023-09-19 06:41:30.504 [pool-4-thread-1] Helm - CHART VERSION: 7.6.4
[INFO ] 2023-09-19 06:41:30.504 [pool-4-thread-1] Helm - APP VERSION: 6.2.7** Please be patient while the chart is being deployed **
[INFO ] 2023-09-19 06:41:30.504 [pool-4-thread-1] Helm - 
[INFO ] 2023-09-19 06:41:30.505 [pool-4-thread-1] Helm - 
[INFO ] 2023-09-19 06:41:30.505 [pool-4-thread-1] Helm - 
[INFO ] 2023-09-19 06:41:30.505 [pool-4-thread-1] Helm - You have deployed a Redis&reg; Cluster accessible only from within you Kubernetes Cluster.INFO: The Job to create the cluster will be created.To connect to your Redis&reg; cluster:
[INFO ] 2023-09-19 06:41:30.505 [pool-4-thread-1] Helm - 
[INFO ] 2023-09-19 06:41:30.505 [pool-4-thread-1] Helm - 1. Run a Redis&reg; pod that you can use as a client:
[INFO ] 2023-09-19 06:41:30.505 [pool-4-thread-1] Helm - kubectl run --namespace operator redis-cluster-client --rm --tty -i --restart='Never' \
[INFO ] 2023-09-19 06:41:30.506 [pool-4-thread-1] Helm - 
[INFO ] 2023-09-19 06:41:30.506 [pool-4-thread-1] Helm - --image docker.io/bitnami/redis-cluster:6.2.7-debian-11-r9 -- bash
[INFO ] 2023-09-19 06:41:30.506 [pool-4-thread-1] Helm - 
[INFO ] 2023-09-19 06:41:30.506 [pool-4-thread-1] Helm - 2. Connect using the Redis&reg; CLI:
[INFO ] 2023-09-19 06:41:30.506 [pool-4-thread-1] Helm - 
[INFO ] 2023-09-19 06:41:30.507 [pool-4-thread-1] Helm - redis-cli -c -h redis-cluster
[INFO ] 2023-09-19 06:41:30.515 [main] ClientsManager - Helm deploy: { kafka: { repo : https://charts.bitnami.com/bitnami },{ values : kubernetes/kafka/values.yaml },{ version : 22.1.3 } }
[INFO ] 2023-09-19 06:41:33.442 [pool-5-thread-1] Helm - NAME: kafka
[INFO ] 2023-09-19 06:41:33.443 [pool-5-thread-1] Helm - LAST DEPLOYED: Tue Sep 19 06:41:32 2023
[INFO ] 2023-09-19 06:41:33.444 [pool-5-thread-1] Helm - NAMESPACE: operator
[INFO ] 2023-09-19 06:41:33.444 [pool-5-thread-1] Helm - STATUS: deployed
[INFO ] 2023-09-19 06:41:33.444 [pool-5-thread-1] Helm - REVISION: 1
[INFO ] 2023-09-19 06:41:33.444 [pool-5-thread-1] Helm - TEST SUITE: None
[INFO ] 2023-09-19 06:41:33.445 [pool-5-thread-1] Helm - NOTES:
[INFO ] 2023-09-19 06:41:33.445 [pool-5-thread-1] Helm - CHART NAME: kafka
[INFO ] 2023-09-19 06:41:33.445 [pool-5-thread-1] Helm - CHART VERSION: 22.1.3
[INFO ] 2023-09-19 06:41:33.445 [pool-5-thread-1] Helm - APP VERSION: 3.4.0
[INFO ] 2023-09-19 06:41:33.445 [pool-5-thread-1] Helm - 
[INFO ] 2023-09-19 06:41:33.446 [pool-5-thread-1] Helm - ** Please be patient while the chart is being deployed **
[INFO ] 2023-09-19 06:41:33.446 [pool-5-thread-1] Helm - 
[INFO ] 2023-09-19 06:41:33.446 [pool-5-thread-1] Helm - Kafka can be accessed by consumers via port 9092 on the following DNS name from within your cluster:
[INFO ] 2023-09-19 06:41:33.446 [pool-5-thread-1] Helm - 
[INFO ] 2023-09-19 06:41:33.446 [pool-5-thread-1] Helm -     kafka.operator.svc.cluster.local
[INFO ] 2023-09-19 06:41:33.447 [pool-5-thread-1] Helm - 
[INFO ] 2023-09-19 06:41:33.447 [pool-5-thread-1] Helm - Each Kafka broker can be accessed by producers via port 9092 on the following DNS name(s) from within your cluster:
[INFO ] 2023-09-19 06:41:33.447 [pool-5-thread-1] Helm - 
[INFO ] 2023-09-19 06:41:33.448 [pool-5-thread-1] Helm -     kafka-0.kafka-headless.operator.svc.cluster.local:9092
[INFO ] 2023-09-19 06:41:33.448 [pool-5-thread-1] Helm -     kafka-1.kafka-headless.operator.svc.cluster.local:9092
[INFO ] 2023-09-19 06:41:33.448 [pool-5-thread-1] Helm -     kafka-2.kafka-headless.operator.svc.cluster.local:9092
[INFO ] 2023-09-19 06:41:33.448 [pool-5-thread-1] Helm -     kafka-3.kafka-headless.operator.svc.cluster.local:9092
[INFO ] 2023-09-19 06:41:33.448 [pool-5-thread-1] Helm -     kafka-4.kafka-headless.operator.svc.cluster.local:9092
[INFO ] 2023-09-19 06:41:33.448 [pool-5-thread-1] Helm - 
[INFO ] 2023-09-19 06:41:33.449 [pool-5-thread-1] Helm - To create a pod that you can use as a Kafka client run the following commands:
[INFO ] 2023-09-19 06:41:33.449 [pool-5-thread-1] Helm - 
[INFO ] 2023-09-19 06:41:33.449 [pool-5-thread-1] Helm -     kubectl run kafka-client --restart='Never' --image docker.io/bitnami/kafka:3.4.0-debian-11-r33 --namespace operator --command -- sleep infinity
[INFO ] 2023-09-19 06:41:33.449 [pool-5-thread-1] Helm -     kubectl exec --tty -i kafka-client --namespace operator -- bash
[INFO ] 2023-09-19 06:41:33.449 [pool-5-thread-1] Helm - 
[INFO ] 2023-09-19 06:41:33.449 [pool-5-thread-1] Helm -     PRODUCER:
[INFO ] 2023-09-19 06:41:33.450 [pool-5-thread-1] Helm -         kafka-console-producer.sh \
[INFO ] 2023-09-19 06:41:33.450 [pool-5-thread-1] Helm -             --broker-list kafka-0.kafka-headless.operator.svc.cluster.local:9092,kafka-1.kafka-headless.operator.svc.cluster.local:9092,kafka-2.kafka-headless.operator.svc.cluster.local:9092,kafka-3.kafka-headless.operator.svc.cluster.local:9092,kafka-4.kafka-headless.operator.svc.cluster.local:9092 \
[INFO ] 2023-09-19 06:41:33.450 [pool-5-thread-1] Helm -             --topic test
[INFO ] 2023-09-19 06:41:33.450 [pool-5-thread-1] Helm - 
[INFO ] 2023-09-19 06:41:33.450 [pool-5-thread-1] Helm -     CONSUMER:
[INFO ] 2023-09-19 06:41:33.450 [pool-5-thread-1] Helm -         kafka-console-consumer.sh \
[INFO ] 2023-09-19 06:41:33.450 [pool-5-thread-1] Helm -             --bootstrap-server kafka.operator.svc.cluster.local:9092 \
[INFO ] 2023-09-19 06:41:33.451 [pool-5-thread-1] Helm -             --topic test \
[INFO ] 2023-09-19 06:41:33.451 [pool-5-thread-1] Helm -             --from-beginning
[INFO ] 2023-09-19 06:41:33.459 [main] ClientsManager - Helm deploy: { generators: { chart : kubernetes/generators } }
[INFO ] 2023-09-19 06:41:33.460 [main] ClientsManager - kubernetes/generators
[INFO ] 2023-09-19 06:41:33.768 [pool-6-thread-1] Helm - NAME: generators
[INFO ] 2023-09-19 06:41:33.769 [pool-6-thread-1] Helm - LAST DEPLOYED: Tue Sep 19 06:41:33 2023
[INFO ] 2023-09-19 06:41:33.770 [pool-6-thread-1] Helm - NAMESPACE: operator
[INFO ] 2023-09-19 06:41:33.770 [pool-6-thread-1] Helm - STATUS: deployed
[INFO ] 2023-09-19 06:41:33.770 [pool-6-thread-1] Helm - REVISION: 1
[INFO ] 2023-09-19 06:41:33.770 [pool-6-thread-1] Helm - TEST SUITE: None
[INFO ] 2023-09-19 06:43:47.571 [main] ClientsManager - Generator started with parameters: {"generatorType":"ADS","topic":"input","brokerList":"kafka.operator.svc.cluster.local:9092","limiterType":"DATASET","limiterMaxNoise":0.1,"amplitude":0,"period":3600,"verticalPhase":300000,"fileName":"datasets/ADS_3D_1S_4_sub_30K_max.csv","header":true,"separator":"|","scale":1.0,"redisHost":"redis-cluster","redisPort":6379}
[INFO ] 2023-09-19 06:44:02.179 [main] ClientsManager - Generator started with parameters: {"generatorType":"ADS","topic":"input","brokerList":"kafka.operator.svc.cluster.local:9092","limiterType":"DATASET","limiterMaxNoise":0.1,"amplitude":0,"period":3600,"verticalPhase":300000,"fileName":"datasets/ADS_3D_1S_4_sub_30K_max.csv","header":true,"separator":"|","scale":1.0,"redisHost":"redis-cluster","redisPort":6379}
[INFO ] 2023-09-19 06:44:16.996 [main] ClientsManager - Generator started with parameters: {"generatorType":"ADS","topic":"input","brokerList":"kafka.operator.svc.cluster.local:9092","limiterType":"DATASET","limiterMaxNoise":0.1,"amplitude":0,"period":3600,"verticalPhase":300000,"fileName":"datasets/ADS_3D_1S_4_sub_30K_max.csv","header":true,"separator":"|","scale":1.0,"redisHost":"redis-cluster","redisPort":6379}
[INFO ] 2023-09-19 06:44:17.017 [main] SequenceFSM - { "apiVersion": "flink.apache.org/v1beta1", "kind": "FlinkDeployment", "metadata": { "name": "operator" }, "spec": { "image": "morgel/flink:1.17.0-java11", "flinkVersion": "v1_17", "imagePullPolicy": "Always", "flinkConfiguration": { "taskmanager.numberOfTaskSlots": "1", "kubernetes.jobmanager.annotations": "prometheus.io/scrape:true,prometheus.io/port:9999", "kubernetes.taskmanager.annotations": "prometheus.io/scrape:true,prometheus.io/port:9999", "metrics.reporter.prom.factory.class": "org.apache.flink.metrics.prometheus.PrometheusReporterFactory","metrics.reporter.prom.port": "9999","heartbeat.timeout": "20000", "heartbeat.interval": "5000", "state.checkpoints.dir": "hdfs://130.149.248.67:9000/flink/checkpoints", "state.savepoints.dir": "hdfs://130.149.248.67:9000/flink/savepoints", "kubernetes.operator.job.autoscaler.enabled": "true", "kubernetes.operator.job.autoscaler.stabilization.interval": "2m", "kubernetes.operator.job.autoscaler.metrics.window": "1m", "kubernetes.operator.job.autoscaler.target.utilization": "0.35", "kubernetes.operator.job.autoscaler.target.utilization.boundary": "0.15", "kubernetes.operator.job.autoscaler.restart.time": "1m", "kubernetes.operator.job.autoscaler.catch-up.duration": "5m", "pipeline.max-parallelism": "24" }, "podTemplate": { "spec": { "containers": [{ "name": "flink-main-container", "ports": [{ "containerPort": 9999, "name": "metrics" }] }] } }, "serviceAccount": "default", "jobManager": { "resource": { "memory": "4096m", "cpu": 1.0 } }, "taskManager": { "resource": { "memory": "4096m", "cpu": 1.0 } }, "job": { "jarURI": "local:///opt/flink/usrlib/jobs-1.0.jar", "entryClass": "de.tu_berlin.dos.arm.streaming_experiment_suite.jobs.YahooStreamingBenchmark", "args": ["--chkInterval", "10000", "--jobName", "operator", "--redisHost", "redis-cluster", "--consumerTopic", "input", "--producerTopic", "output", "--redisPort", "6379", "--chkDir", "hdfs://130.149.248.67:9000/flink/checkpoints", "--brokerList", "kafka.operator.svc.cluster.local:9092"], "parallelism": 24, "upgradeMode": "savepoint", "state": "running" }}}
[WARN ] 2023-09-19 06:44:17.037 [main] VersionUsageUtils - The client is using resource type 'flinkdeployments' with unstable version 'v1beta1'
[INFO ] 2023-09-19 06:45:17.158 [main] SequenceFSM - Started target job: FlinkJob{port=32760, entryClass='de.tu_berlin.dos.arm.streaming_experiment_suite.jobs.YahooStreamingBenchmark', jobName='operator', brokerList='kafka.operator.svc.cluster.local:9092', consTopic='input', prodTopic='output', extraArgs={redisHost=redis-cluster, redisPort=6379}, config={scaleOut: 24, taskSlots: 1, cpu: 1.0, memory: 4096, chkInt: 10000}, tsList=[1695105918], jobId='27bcfa1eb65fcafa67e9ecdc4b4a904f', isActive=true} at TS: 1695105918
[INFO ] 2023-09-19 06:45:17.159 [main] SequenceFSM - STATE-CHANGE: INITIALIZE -> EXECUTE
[INFO ] 2023-09-19 06:45:17.170 [main] SequenceFSM - Starting Experiment: 1695105918
[INFO ] 2023-09-19 07:30:21.012 [pool-2-thread-1] SequenceFSM - Injecting delay into target job: operator at TS: 1695108622
[WARN ] 2023-09-19 07:30:21.036 [pool-2-thread-1] VersionUsageUtils - The client is using resource type 'networkchaos' with unstable version 'v1alpha1'
[INFO ] 2023-09-19 08:15:20.016 [pool-2-thread-2] SequenceFSM - Injecting delay into target job: operator at TS: 1695111321
[INFO ] 2023-09-19 09:00:23.004 [pool-2-thread-3] SequenceFSM - Injecting delay into target job: operator at TS: 1695114024
[INFO ] 2023-09-19 09:45:20.012 [pool-2-thread-4] SequenceFSM - Injecting delay into target job: operator at TS: 1695116721
[INFO ] 2023-09-19 10:30:26.012 [pool-2-thread-5] SequenceFSM - Injecting delay into target job: operator at TS: 1695119427
[ERROR] 2023-09-19 11:15:18.031 [pool-2-thread-6] Listener - java.lang.IllegalStateException: Not a JSON Object: null
[INFO ] 2023-09-19 12:00:20.004 [pool-2-thread-7] SequenceFSM - Injecting delay into target job: operator at TS: 1695124821
[INFO ] 2023-09-19 12:45:23.006 [pool-2-thread-8] SequenceFSM - Injecting delay into target job: operator at TS: 1695127524
[INFO ] 2023-09-19 13:30:18.005 [pool-2-thread-9] SequenceFSM - Injecting delay into target job: operator at TS: 1695130219
[INFO ] 2023-09-19 14:15:36.007 [pool-2-thread-10] SequenceFSM - Injecting delay into target job: operator at TS: 1695132937
[INFO ] 2023-09-19 15:00:21.009 [pool-2-thread-11] SequenceFSM - Injecting delay into target job: operator at TS: 1695135622
[ERROR] 2023-09-19 15:45:20.075 [pool-2-thread-12] Listener - java.net.ConnectException: Failed to connect to /130.149.248.67:32760
[INFO ] 2023-09-19 16:30:22.011 [pool-2-thread-13] SequenceFSM - Injecting delay into target job: operator at TS: 1695141023
[INFO ] 2023-09-19 17:15:27.005 [pool-2-thread-14] SequenceFSM - Injecting delay into target job: operator at TS: 1695143728
[INFO ] 2023-09-19 18:00:24.009 [pool-2-thread-15] SequenceFSM - Injecting delay into target job: operator at TS: 1695146425
[INFO ] 2023-09-19 18:45:25.008 [pool-2-thread-16] SequenceFSM - Injecting delay into target job: operator at TS: 1695149126
[ERROR] 2023-09-19 19:30:17.006 [pool-2-thread-17] Listener - java.io.IOException: unexpected end of stream on Connection{130.149.248.67:32760, proxy=DIRECT hostAddress=/130.149.248.67:32760 cipherSuite=none protocol=http/1.1}
[INFO ] 2023-09-19 20:15:20.013 [pool-2-thread-18] SequenceFSM - Injecting delay into target job: operator at TS: 1695154521
[INFO ] 2023-09-19 21:00:25.004 [pool-2-thread-19] SequenceFSM - Injecting delay into target job: operator at TS: 1695157226
[INFO ] 2023-09-19 21:45:18.005 [pool-2-thread-20] SequenceFSM - Injecting delay into target job: operator at TS: 1695159919
[INFO ] 2023-09-19 22:30:20.010 [pool-2-thread-21] SequenceFSM - Injecting delay into target job: operator at TS: 1695162621
[INFO ] 2023-09-19 23:15:19.012 [pool-2-thread-22] SequenceFSM - Injecting delay into target job: operator at TS: 1695165320
[INFO ] 2023-09-20 00:00:18.009 [pool-2-thread-23] SequenceFSM - Injecting delay into target job: operator at TS: 1695168019
[INFO ] 2023-09-20 00:45:17.012 [main] SequenceFSM - Stopping Experiment: 1695170718
[INFO ] 2023-09-20 00:45:17.015 [main] SequenceFSM - Gathering metrics and stopping job with configuration: FlinkJob{port=32760, entryClass='de.tu_berlin.dos.arm.streaming_experiment_suite.jobs.YahooStreamingBenchmark', jobName='operator', brokerList='kafka.operator.svc.cluster.local:9092', consTopic='input', prodTopic='output', extraArgs={redisHost=redis-cluster, redisPort=6379}, config={scaleOut: 24, taskSlots: 1, cpu: 1.0, memory: 4096, chkInt: 10000}, tsList=[1695105918, 1695108622, 1695111321, 1695114024, 1695116721, 1695119427, 1695124821, 1695127524, 1695130219, 1695132937, 1695135622, 1695141023, 1695143728, 1695146425, 1695149126, 1695154521, 1695157226, 1695159919, 1695162621, 1695165320, 1695168019, 1695170718], jobId='27bcfa1eb65fcafa67e9ecdc4b4a904f', isActive=true}
[INFO ] 2023-09-20 00:45:27.014 [pool-2-thread-24] SequenceFSM - Injecting delay into target job: operator at TS: 1695170728
[INFO ] 2023-09-20 00:50:29.680 [pool-2-thread-27] TimeSeries - File not found, creating 1_operator_workRate.out
[INFO ] 2023-09-20 00:50:29.680 [pool-2-thread-25] TimeSeries - File not found, creating 1_operator_taskSlots.out
[INFO ] 2023-09-20 00:50:29.680 [pool-2-thread-28] TimeSeries - File not found, creating 1_operator_scaleOuts.out
[INFO ] 2023-09-20 00:50:29.680 [pool-2-thread-26] TimeSeries - File not found, creating 1_operator_consLag.out
[INFO ] 2023-09-20 00:50:29.680 [pool-2-thread-29] TimeSeries - File not found, creating 1_operator_thrRate.out
[INFO ] 2023-09-20 00:50:29.680 [pool-2-thread-31] TimeSeries - File not found, creating 1_operator_cpuLoad.out
[INFO ] 2023-09-20 00:50:29.680 [pool-2-thread-30] TimeSeries - File not found, creating 1_operator_latency.out
